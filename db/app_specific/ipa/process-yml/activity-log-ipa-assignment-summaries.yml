# @library ipa enabled_if

_default:

  view_options:
    show_embedded_at_top: true
    hide_unless_creatable: true

  fields:
    - notes

  caption_before:
    notes: Additional Notes

  field_options:
    notes:
      format: markdown

  showable_if: *enabled_if
  creatable_if: *enabled_if
  editable_if: *enabled_if


medical_history:


  references:
    dynamic_model__ipa_medical_details:
      label: Medical History
      from: master
      add: one_to_master
      view_as:
        new: not_embedded
        #show: readonly
      prevent_disable: true

  creatable_if:
    not_all:
      activity_log__ipa_assignment_summaries:
        extra_log_type: medical_history

  save_trigger:
    on_create:
      create_reference:
        - dynamic_model__ipa_medical_detail:
            in: master_with_reference
            with:
              convulsion_or_seizure_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_tms_tests:
                  convulsion_or_seizure_blank_yes_no_dont_know: return_value
              convulsion_or_seizure_details:
                dynamic_model__ipa_ps_tms_tests:
                  convulsion_or_seizure_details: return_value
              sleep_disorder_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_sleeps:
                  sleep_disorder_blank_yes_no_dont_know: return_value
              sleep_disorder_details:
                dynamic_model__ipa_ps_sleeps:
                  sleep_disorder_details: return_value
              sleep_apnea_device_no_yes:
                dynamic_model__ipa_ps_sleeps:
                  sleep_apnea_device_no_yes: return_value
              sleep_apnea_device_details:
                dynamic_model__ipa_ps_sleeps:
                  sleep_apnea_device_details: return_value
              chronic_pain_blank_yes_no:
                dynamic_model__ipa_ps_healths:
                  chronic_pain_blank_yes_no: return_value
              chronic_pain_details:
                dynamic_model__ipa_ps_healths:
                  chronic_pain_details: return_value
              chronic_pain_meds_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  chronic_pain_meds_blank_yes_no_dont_know: return_value
              chronic_pain_meds_details:
                dynamic_model__ipa_ps_healths:
                  chronic_pain_meds_details: return_value
              hypertension_diagnosis_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  hypertension_diagnosis_blank_yes_no_dont_know: return_value
              hypertension_medications_blank_yes_no:
                dynamic_model__ipa_ps_healths:
                  hypertension_medications_blank_yes_no: return_value
              hypertension_diagnosis_details:
                dynamic_model__ipa_ps_healths:
                  hypertension_diagnosis_details: return_value
              diabetes_diagnosis_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  diabetes_diagnosis_blank_yes_no_dont_know: return_value
              diabetes_medications_blank_yes_no:
                dynamic_model__ipa_ps_healths:
                  diabetes_medications_blank_yes_no: return_value
              diabetes_diagnosis_details:
                dynamic_model__ipa_ps_healths:
                  diabetes_diagnosis_details: return_value
              hemophilia_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  hemophilia_blank_yes_no_dont_know: return_value
              hemophilia_details:
                dynamic_model__ipa_ps_healths:
                  hemophilia_details: return_value
              high_cholesterol_diagnosis_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  high_cholesterol_diagnosis_blank_yes_no_dont_know: return_value
              high_cholesterol_medications_blank_yes_no:
                dynamic_model__ipa_ps_healths:
                  high_cholesterol_medications_blank_yes_no: return_value
              high_cholesterol_diagnosis_details:
                dynamic_model__ipa_ps_healths:
                  high_cholesterol_diagnosis_details: return_value
              caridiac_pacemaker_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  caridiac_pacemaker_blank_yes_no_dont_know: return_value
              caridiac_pacemaker_details:
                dynamic_model__ipa_ps_healths:
                  caridiac_pacemaker_details: return_value
              other_heart_conditions_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  other_heart_conditions_blank_yes_no_dont_know: return_value
              other_heart_conditions_details:
                dynamic_model__ipa_ps_healths:
                  other_heart_conditions_details: return_value
              memory_problems_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  memory_problems_blank_yes_no_dont_know: return_value
              memory_problems_details:
                dynamic_model__ipa_ps_healths:
                  memory_problems_details: return_value
              mental_health_conditions_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  mental_health_conditions_blank_yes_no_dont_know: return_value
              mental_health_conditions_details:
                dynamic_model__ipa_ps_healths:
                  mental_health_conditions_details: return_value
              mental_health_help_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  mental_health_help_blank_yes_no_dont_know: return_value
              mental_health_help_details:
                dynamic_model__ipa_ps_healths:
                  mental_health_help_details: return_value
              neurological_problems_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_healths:
                  neurological_problems_blank_yes_no_dont_know: return_value
              neurological_problems_details:
                dynamic_model__ipa_ps_healths:
                  neurological_problems_details: return_value
              past_mri_yes_no_dont_know:
                dynamic_model__ipa_ps_mris:
                  past_mri_yes_no_dont_know: return_value
              past_mri_details:
                dynamic_model__ipa_ps_mris:
                  past_mri_details: return_value
              metal_implants_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_mris:
                  metal_implants_blank_yes_no_dont_know: return_value
              metal_implants_details:
                dynamic_model__ipa_ps_mris:
                  metal_implants_details: return_value
              dietary_restrictions_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_tms_tests:
                  dietary_restrictions_blank_yes_no_dont_know: return_value
              dietary_restrictions_details:
                dynamic_model__ipa_ps_tms_tests:
                  dietary_restrictions_details: return_value
              radiation_blank_yes_no:
                dynamic_model__ipa_ps_mris:
                  radiation_blank_yes_no: return_value
              radiation_details:
                dynamic_model__ipa_ps_mris:
                  radiation_details: return_value


medications:


  references:
    dynamic_model__ipa_medications:
      label: Medications
      from: master
      add: one_to_master
      view_as:
        #show: readonly
        new: not_embedded
      prevent_disable: true

  creatable_if:
    not_all:
      activity_log__ipa_assignment_summaries:
        extra_log_type: medications

  save_trigger:
    on_create:
      create_reference:
        - dynamic_model__ipa_medications:
            in: master_with_reference
            with:
              current_meds_blank_yes_no_dont_know:
                dynamic_model__ipa_ps_tms_tests:
                  current_meds_blank_yes_no_dont_know: return_value
              current_meds_details:
                dynamic_model__ipa_ps_tms_tests:
                  current_meds_details: return_value

special_considerations:


  references:
    dynamic_model__ipa_special_considerations:
      label: Medications
      from: master
      add: one_to_master
      view_as:
#        show: readonly
        new: not_embedded

      prevent_disable: true

  creatable_if:
    not_all:
      activity_log__ipa_assignment_summaries:
        extra_log_type: special_considerations

  save_trigger:
    on_create:
      create_reference:
        - dynamic_model__ipa_special_considerations:
            in: master_with_reference
            with:
              #travel_with_wife_yes_no:
              #  dynamic_model__ipa_ps_tms_tests:
              #    travel_with_wife_yes_no: return_value
              #travel_with_wife_details:
              #  dynamic_model__ipa_ps_tms_tests:
              #    travel_with_wife_details: return_value
              #mmse_yes_no: 'yes'

              tmoca_score:
                dynamic_model__ipa_ps_tmocas:
                  tmoca_score: return_value
              #bringing_cpap_yes_no:
              #  dynamic_model__ipa_ps_tms_tests:
              #    bringing_cpap_yes_no: return_value
              #tms_exempt_yes_no:
              #  dynamic_model__ipa_ps_tms_tests:
              #    tms_exempt_yes_no: return_value
              #taking_med_for_mri_pet_yes_no:
              #  dynamic_model__ipa_ps_tms_tests:
              #    taking_med_for_mri_pet_yes_no: return_value
