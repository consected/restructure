# User Profile Configuration and Management

## Creating User Profiles

Only application _admins_ have the ability to create _user_ profiles. This is performed through the **Usernames and Passwords** administration panel. A new _user_ is created by submitting his or her email address. This action creates a random password, which is displayed to the _admin_ one time only and a simple document containing this information for the end user. The _admin_ is responsible for delivering this document to the end-user securely.

## Resetting User Passwords

Only _admins_ have the ability to reset a _userâ€™s_ password if the _user_ is unable to login for some reason. This is performed through the application **Usernames and Passwords** administration panel.

To reset a password, the _admin_ selects the _user_ from a list, edits the profile and selects the option: **generate new password**. Similar to creating a _user_ initially, the _admin_ is displayed a new random password for the _user_one time only and a simple document containing this information for the end user. The_admin_ is responsible for delivering this document to the end-user securely.
{{#if mfa_disabled}} {{else}}

## Two-Factor Authentication (2FA)

The server may be configured to require users to login using a two-factor authentication token in addition to username and password.

Two-Factor Authentication (2FA) is implemented by requiring the entry of a time-based token at login time. Commonly available authenticator smartphone apps are used by users to generate this token. Users will see this token referred to in the app as a **one-time token**.

Each _user and admin profile has a unique_2FA_ secret generated when a new profile is created, or if reset by the administrator. The administrator does not get to see this secret, and it is stored in the database in an encrypted format.

The first time that a user logs in after creation of a profile or reset of the _2FA_ secret they are presented with a two-factor authentication configuration page. This page provides a convenient QR Code barcode used by smartphone authenticator apps to set up a profile for future token generation. Once a token is entered and validated this first time the secret can not be viewed again and must be reset by an administrator if the user is no longer able to use it.  To reset the secret, the admin edits the _user_ profile and selects the option: **Reset two factor auth**
{{/if}}

## Unlock Expired Account

A user's account will be locked if their password is not changed for more than **{{password_age_limit}} days**. To simplify administration, admins may unlock accounts that have expired in this way, for an additional **5 days**. This provides the user sufficient time to login with their existing password and change it without additional admin intervention. To perform this, edit the user's account and check **Unlock expired account**.

## Unlock Failed Password Attempts

A user's account will be locked if they fail to login correctly **{{password_max_attempts}} times**. They can wait **{{password_unlock_time_mins}} minutes** and their account
will automatically unlock. Alternatively, the admin may unlock the account immediately by editing the account and checking **Unlock failed password attempts**

## Changing User Passwords

A _user_ has the ability to change their own password. After logging in to the application, an option to change the password is made available in the menu. This requires both the current and new _user_ passwords to be entered.

Similarly, an _admin_ has the ability to change their own password. After logging in to the application management panel an option to change the password is made available. This requires both the current and new _admin_ passwords to be entered.

## Password Complexity

Passwords, whether automatically generated by an _admin_, or changed by a _user_, must meet specific rules based on the server configuration:

* Minimum characters: {{password_min_length}}
* Maximum characters: 72
* Does not match email address
{{#if password_regex_requirements}}* Matches a specific pattern `{{password_regex_requirements}}`{{/if}}

Optionally, an entropy calculation may be defined to enforce password complexity. This is harder for some users to meet, but does
enforce complex passwords where users make use of password managers that generate long, complex passwords. The minimum entropy score is "**{{password_min_entropy}}**".
If this is **0** or _blank_ then the entropy calculation is ignored.

Calculation of an [entropy score](http://cubicspot.blogspot.com/2011/11/how-to-calculate-password-strength.html) is performed (if configured), and is reduced for:

* Repeated characters
* Words appearing in Linux dictionary words file
* Words in a list of common passwords
* Words appearing in any part of the email address

## Disabling User Access

A _user_ profile can be disabled by an _admin_ through the **Usernames and Passwords** admin panel. This action prevents a _user_ from logging in or attempting to change her password.

In the future, an admin can re-enable a _user_ profile if needed.

There is no way to delete a _user_ profile from the application. This ensures that all data records created or updated by a _user_ retain a reference to the profile responsible for editing them.
