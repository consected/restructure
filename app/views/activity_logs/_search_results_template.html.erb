<% ActivityLog.enabled.each do |m|
  l = []


  an = m.attribute_names - ['id', 'created_at', 'updated_at', 'contactid', 'user_id', 'master_id']

  if an.length > 1
    l = an
  else
    an.each do |k|
      l << [label: k.to_s.humanize, formatter: 'format_sage_id', attribute: k.to_s]
    end
  end

  template_file = "_#{m.model_def_name}_search_results_template.html.erb"

  if File.exist?("#{Rails.root.join 'app', 'views', 'activity_logs', template_file}")
    template_name = "activity_logs/#{m.model_def_name}_search_results_template"
  else
    template_name = 'common_templates/search_results_template'
  end
%>
<%= render partial: template_name, locals: {
      caption: m.name,
      name: m.item_type_name,
      prevent_edit: true,
      prevent_create: true,
      item_list: l
    } %>
<% end %>
